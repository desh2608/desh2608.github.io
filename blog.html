---
layout: page
title: Blog
---

<div class="blog-header">
  <p class="blog-description">
    Thoughts on machine learning, speech processing, and research.
    <span class="post-count" id="post-count">{{ site.posts.size }} articles</span>
  </p>

  <div class="search-container">
    <div class="search-box">
      <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
        xmlns="http://www.w3.org/2000/svg">
        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" />
        <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
      <input type="text" id="blog-search" placeholder="Search posts by title, content, or tags..." autocomplete="off">
      <button type="button" id="clear-search" class="clear-search" style="display: none;" title="Clear search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
          <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
      </button>
    </div>
  </div>
</div>

<div class="blog-grid">
  {% for post in site.posts %}
  {% comment %} Extract first image from post content for card display {% endcomment %}
  {% assign image_url = '' %}

  {% comment %} Look for markdown images first {% endcomment %}
  {% assign md_images = post.content | split: '![' %}
  {% if md_images.size > 1 %}
  {% for md_img in md_images %}
  {% if md_img contains '](' %}
  {% assign img_parts = md_img | split: '](' %}
  {% if img_parts.size > 1 %}
  {% assign potential_url = img_parts[1] | split: ')' | first | strip %}
  {% if potential_url contains '/static/img/' or potential_url contains '.png' or potential_url contains '.jpg' or
  potential_url contains '.jpeg' or potential_url contains '.gif' %}
  {% assign image_url = potential_url %}
  {% break %}
  {% endif %}
  {% endif %}
  {% endif %}
  {% endfor %}
  {% endif %}

  {% comment %} Fallback: look for HTML img tags {% endcomment %}
  {% if image_url == '' %}
  {% assign html_images = post.content | split: '<img ' %}
      {% if html_images.size > 1 %}
        {% assign img_tag = html_images[1] | split: '>' | first %}
  {% if img_tag contains 'src="' %}
  {% assign image_url = img_tag | split: 'src="' | last | split: '"' | first | strip %}
  {% endif %}
  {% endif %}
  {% endif %}

  <article class="blog-card">
    {% if image_url != '' and image_url != empty %}
    <div class="blog-card-image">
      <a href="{{ post.url | relative_url }}">
        <img src="{{ image_url | relative_url }}" alt="{{ post.title }}" loading="lazy">
      </a>
    </div>
    {% endif %}

    <div class="blog-card-content">
      <header class="blog-card-header">
        <time class="blog-date" datetime="{{ post.date | date_to_xmlschema }}">
          {{ post.date | date: "%B %d, %Y" }}
        </time>
        <h2 class="blog-title">
          <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
        </h2>
      </header>

      <div class="blog-excerpt">
        {% if post.excerpt %}
        {{ post.excerpt | strip_html | truncatewords: 25 }}
        {% else %}
        {{ post.content | strip_html | truncatewords: 25 }}
        {% endif %}
      </div>

      {% if post.tags and post.tags.size > 0 %}
      <div class="blog-tags">
        {% for tag in post.tags limit:3 %}
        <span class="blog-tag">{{ tag }}</span>
        {% endfor %}
        {% if post.tags.size > 3 %}
        <span class="blog-tag-more">+{{ post.tags.size | minus: 3 }} more</span>
        {% endif %}
      </div>
      {% endif %}

      <div class="blog-card-footer">
        <a href="{{ post.url | relative_url }}" class="read-more">
          Read more
          <svg class="read-more-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </a>

        {% if post.mathjax %}
        <span class="math-indicator" title="Contains mathematical content">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L3 7L12 12L21 7L12 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <path d="M3 17L12 22L21 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <path d="M3 12L12 17L21 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </span>
        {% endif %}
      </div>
    </div>
  </article>
  {% endfor %}
</div>

{% if site.posts.size == 0 %}
<div class="empty-state">
  <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round" />
    <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
    <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
    <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
    <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round" />
  </svg>
  <h2>No posts yet</h2>
  <p>Check back soon for new content!</p>
</div>
{% endif %}

<!-- Search Data for JavaScript -->
<script type="application/json" id="search-data">
[
  {% for post in site.posts %}
  {
    "title": {{ post.title | jsonify }},
    "date": "{{ post.date | date: '%B %d, %Y' }}",
    "url": "{{ post.url | relative_url }}",
    "excerpt": {{ post.excerpt | default: post.content | strip_html | truncatewords: 25 | jsonify }},
    "content": {{ post.content | strip_html | jsonify }},
    "tags": {{ post.tags | jsonify }},
    "mathjax": {{ post.mathjax | jsonify }}
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
</script>

<!-- Blog Search JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('blog-search');
    const clearButton = document.getElementById('clear-search');
    const postCount = document.getElementById('post-count');
    const blogGrid = document.querySelector('.blog-grid');
    const blogCards = document.querySelectorAll('.blog-card');
    const searchData = JSON.parse(document.getElementById('search-data').textContent);

    let totalPosts = blogCards.length;

    // Search functionality
    function performSearch(query) {
      const normalizedQuery = query.toLowerCase().trim();

      if (!normalizedQuery) {
        showAllPosts();
        return;
      }

      let visibleCount = 0;

      blogCards.forEach((card, index) => {
        const post = searchData[index];
        const matchesQuery =
          post.title.toLowerCase().includes(normalizedQuery) ||
          post.content.toLowerCase().includes(normalizedQuery) ||
          post.excerpt.toLowerCase().includes(normalizedQuery) ||
          post.tags.some(tag => tag.toLowerCase().includes(normalizedQuery));

        if (matchesQuery) {
          card.style.display = 'flex';
          card.style.animation = 'fadeInUp 0.3s ease-out';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });

      updatePostCount(visibleCount, normalizedQuery);
      showNoResultsIfNeeded(visibleCount, normalizedQuery);
    }

    function showAllPosts() {
      blogCards.forEach(card => {
        card.style.display = 'flex';
        card.style.animation = 'fadeInUp 0.3s ease-out';
      });
      updatePostCount(totalPosts);
      hideNoResults();
    }

    function updatePostCount(count, query = '') {
      if (query) {
        postCount.textContent = `${count} result${count !== 1 ? 's' : ''} for "${query}"`;
      } else {
        postCount.textContent = `${count} article${count !== 1 ? 's' : ''}`;
      }
    }

    function showNoResultsIfNeeded(count, query) {
      hideNoResults();

      if (count === 0) {
        const noResults = document.createElement('div');
        noResults.className = 'no-search-results';
        noResults.innerHTML = `
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="11" y1="8" x2="11" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="8" y1="11" x2="14" y2="11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <h2>No posts found</h2>
        <p>No articles match your search for "<strong>${query}</strong>". Try different keywords or browse all posts.</p>
        <button onclick="clearSearch()" class="clear-search-btn">Clear search</button>
      `;

        blogGrid.appendChild(noResults);
      }
    }

    function hideNoResults() {
      const existing = document.querySelector('.no-search-results');
      if (existing) {
        existing.remove();
      }
    }

    function clearSearch() {
      searchInput.value = '';
      clearButton.style.display = 'none';
      showAllPosts();
      searchInput.focus();
    }

    // Make clearSearch globally available
    window.clearSearch = clearSearch;

    // Search input events
    searchInput.addEventListener('input', function () {
      const query = this.value;

      if (query.length > 0) {
        clearButton.style.display = 'block';
      } else {
        clearButton.style.display = 'none';
      }

      // Debounce search for better performance
      clearTimeout(searchInput.searchTimeout);
      searchInput.searchTimeout = setTimeout(() => {
        performSearch(query);
      }, 150);
    });

    // Clear button event
    clearButton.addEventListener('click', clearSearch);

    // Keyboard shortcuts
    searchInput.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        clearSearch();
      }
    });

    // Focus search on Ctrl/Cmd + K
    document.addEventListener('keydown', function (e) {
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        searchInput.focus();
      }
    });
  });
</script>
